---

title: Core

keywords: fastai
sidebar: home_sidebar

summary: "Methods intended to be called publically"
description: "Methods intended to be called publically"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: Core.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="import_docs" class="doc_header"><code>import_docs</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/core.py#L29" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>import_docs</code>(<strong><code>path_to_file_list</code></strong>, <strong><code>verbose</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Imports and processes the list of documents contained in the given file</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="sentences_to_disk" class="doc_header"><code>sentences_to_disk</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/core.py#L62" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>sentences_to_disk</code>(<strong><code>raw_sentences</code></strong>, <strong><code>outfile_name</code></strong>)</p>
</blockquote>
<p>Writes the raw sentences to a file organized by document and sentence number</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_doc_top_phrases" class="doc_header"><code>get_doc_top_phrases</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/core.py#L72" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_doc_top_phrases</code>(<strong><code>raw_docs</code></strong>, <strong><code>feature_names</code></strong>, <strong><code>tdm</code></strong>, <strong><code>window_size</code></strong>=<em><code>6</code></em>, <strong><code>include_input_in_tfidf</code></strong>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_doc_word_vectors_tfidf" class="doc_header"><code>get_doc_word_vectors_tfidf</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/core.py#L82" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_doc_word_vectors_tfidf</code>(<strong><code>doc_top_phrases</code></strong>, <strong><code>dictionary</code></strong>, <strong><code>tfidf_dense</code></strong>)</p>
</blockquote>
<p>Uses the TF-IDF matrix to create a list of lists corresponding to a word vectors for the top phrases of each sentence in each document</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_doc_word_vectors_svd" class="doc_header"><code>get_doc_word_vectors_svd</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/core.py#L86" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_doc_word_vectors_svd</code>(<strong><code>doc_top_phrases</code></strong>, <strong><code>dictionary</code></strong>, <strong><code>tfidf_dense</code></strong>, <strong><code>dimensions</code></strong>=<em><code>2</code></em>)</p>
</blockquote>
<p>Decomposes the TF-IDF matrix via SVD and uses the result to create a list of lists corresponding to a word vectors for the top phrases of each sentence in each document</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_doc_word_vectors_umap" class="doc_header"><code>get_doc_word_vectors_umap</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/core.py#L92" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_doc_word_vectors_umap</code>(<strong><code>doc_top_phrases</code></strong>, <strong><code>dictionary</code></strong>, <strong><code>tfidf_dense</code></strong>, <strong><code>umap_neighbors</code></strong>=<em><code>15</code></em>, <strong><code>dimensions</code></strong>=<em><code>2</code></em>)</p>
</blockquote>
<p>Transforms the TF-IDF matrix via UMAP and uses the result to create a list of lists corresponding to a word vectors for the top phrases of each sentence in each document</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_doc_word_vectors_pretrained" class="doc_header"><code>get_doc_word_vectors_pretrained</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/core.py#L98" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_doc_word_vectors_pretrained</code>(<strong><code>doc_top_phrases</code></strong>, <strong><code>path_to_w2v_bin_file</code></strong>)</p>
</blockquote>
<p>Uses pretrained Word2Vec embeddings to create a list of lists corresponding to a word vectors for the top phrases of each sentence in each document</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_doc_word_vectors_local" class="doc_header"><code>get_doc_word_vectors_local</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/core.py#L104" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_doc_word_vectors_local</code>(<strong><code>doc_top_phrases</code></strong>, <strong><code>raw_docs</code></strong>, <strong><code>my_docs</code></strong>)</p>
</blockquote>
<p>Creates Word2Vec embeddings from the input corpus and uses them to create a list of lists corresponding to a word vectors for the top phrases of each sentence in each document</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="filter_sentences" class="doc_header"><code>filter_sentences</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/core.py#L110" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>filter_sentences</code>(<strong><code>doc_phrase_vecs</code></strong>, <strong><code>doc_top_phrases</code></strong>)</p>
</blockquote>
<p>Filter the sentences, removing any that contain zero 'top phrases'</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_optimal_k" class="doc_header"><code>get_optimal_k</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/core.py#L132" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_optimal_k</code>(<strong><code>just_phrase_vecs</code></strong>, <strong><code>save_chart</code></strong>=<em><code>False</code></em>, <strong><code>chart_file</code></strong>=<em><code>'KmeansSilhouette.png'</code></em>)</p>
</blockquote>
<p>Clusters the top phrase vectors for a range of k values and plots the silhoute coefficients
(this is a function of mean intra-cluster distance and mean nearest-cluster distance).
Returns the optimal k-value (highest silhoute coefficient)</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_cluster_assignments_kmeans" class="doc_header"><code>get_cluster_assignments_kmeans</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/core.py#L147" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_cluster_assignments_kmeans</code>(<strong><code>k</code></strong>, <strong><code>just_phrase_vecs</code></strong>)</p>
</blockquote>
<p>Use K-means algorithm to cluster phrase vectors</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_linkage_matrix" class="doc_header"><code>get_linkage_matrix</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/core.py#L156" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_linkage_matrix</code>(<strong><code>just_phrase_vecs</code></strong>, <strong><code>dist_metric</code></strong>)</p>
</blockquote>
<p>Creates a linkage matrix by calculating distance between phrase vectors</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_optimal_height" class="doc_header"><code>get_optimal_height</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/core.py#L164" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_optimal_height</code>(<strong><code>just_phrase_vecs</code></strong>, <strong><code>linkage_matrix</code></strong>, <strong><code>save_chart</code></strong>=<em><code>False</code></em>, <strong><code>chart_file</code></strong>=<em><code>'HACSilhouette.png'</code></em>)</p>
</blockquote>
<p>Clusters the top phrase vectors and plots the silhoute coefficients for a range of dendrograph heights.
Returns the optimal height value (highest silhoute coefficient)</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_cluster_assignments_hac" class="doc_header"><code>get_cluster_assignments_hac</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/core.py#L182" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_cluster_assignments_hac</code>(<strong><code>linkage_matrix</code></strong>, <strong><code>height</code></strong>)</p>
</blockquote>
<p>Use Hierarchical Agglomerative Clustering to cluster phrase vectors</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="visualize_umap" class="doc_header"><code>visualize_umap</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/core.py#L187" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>visualize_umap</code>(<strong><code>just_phrase_ids</code></strong>, <strong><code>cluster_assignments</code></strong>, <strong><code>just_phrase_text</code></strong>, <strong><code>dist</code></strong>, <strong><code>umap_neighbors</code></strong>=<em><code>15</code></em>, <strong><code>save_chart</code></strong>=<em><code>False</code></em>, <strong><code>chart_file</code></strong>=<em><code>'UMAP.html'</code></em>)</p>
</blockquote>
<p>Visualize the clusters using UMAP</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="visualize_mds" class="doc_header"><code>visualize_mds</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/core.py#L197" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>visualize_mds</code>(<strong><code>just_phrase_ids</code></strong>, <strong><code>cluster_assignments</code></strong>, <strong><code>just_phrase_text</code></strong>, <strong><code>dist</code></strong>, <strong><code>save_chart</code></strong>=<em><code>False</code></em>, <strong><code>chart_file</code></strong>=<em><code>'MDS.html'</code></em>)</p>
</blockquote>
<p>Visualize the clusters using Multi-Dimensional Scaling (MDS)</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="visualize_svd" class="doc_header"><code>visualize_svd</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/core.py#L208" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>visualize_svd</code>(<strong><code>just_phrase_ids</code></strong>, <strong><code>cluster_assignments</code></strong>, <strong><code>just_phrase_text</code></strong>, <strong><code>dist</code></strong>, <strong><code>save_chart</code></strong>=<em><code>False</code></em>, <strong><code>chart_file</code></strong>=<em><code>'SVD.html'</code></em>)</p>
</blockquote>
<p>Visualize the clusters using Singular Value Decomposition (SVD)</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_cluster_topics" class="doc_header"><code>get_cluster_topics</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/core.py#L218" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_cluster_topics</code>(<strong><code>cluster_assignments</code></strong>, <strong><code>just_phrase_ids</code></strong>, <strong><code>my_docs</code></strong>)</p>
</blockquote>
<p>Gets a list of the main topics for each cluster</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="write_output_to_disk" class="doc_header"><code>write_output_to_disk</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/core.py#L247" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>write_output_to_disk</code>(<strong><code>main_cluster_topics</code></strong>, <strong><code>just_phrase_ids</code></strong>, <strong><code>cluster_assignments</code></strong>, <strong><code>raw_sentences</code></strong>, <strong><code>doc_top_phrases</code></strong>, <strong><code>file_list</code></strong>, <strong><code>file_name</code></strong>=<em><code>'TopicClusterResults.txt'</code></em>)</p>
</blockquote>
<p>Creates a CSV file listing cluster_id/doc_id/doc_name/sentence_id/sentence_text/sentences_phrases</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="evaluate" class="doc_header"><code>evaluate</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/core.py#L265" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>evaluate</code>(<strong><code>just_phrase_ids</code></strong>, <strong><code>cluster_assignments</code></strong>, <strong><code>just_phrase_text</code></strong>, <strong><code>gold_file</code></strong>=<em><code>'data/GOLD_Expert_2019.03.12_TestCorpus_AMY.txt'</code></em>, <strong><code>output_file</code></strong>=<em><code>'output/EvaluationResults.txt'</code></em>)</p>
</blockquote>
<p>Evaluate precision, recall, and F1 against a gold standard dataset. Write results to a file</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}
</div>
 

