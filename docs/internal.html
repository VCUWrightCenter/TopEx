---

title: Internal

keywords: fastai
sidebar: home_sidebar

summary: "Internal MedTop methods"
description: "Internal MedTop methods"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: internal.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-processing">Data processing<a class="anchor-link" href="#Data-processing"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_phrase" class="doc_header"><code>get_phrase</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/internal.py#L22" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_phrase</code>(<strong><code>sent</code></strong>, <strong><code>window_size</code></strong>, <strong><code>feature_names</code></strong>, <strong><code>include_input_in_tfidf</code></strong>, <strong><code>tdm</code></strong>, <strong><code>token_averages</code></strong>)</p>
</blockquote>
<p>Finds the most expressive phrase in a sentence.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_vector_tfidf" class="doc_header"><code>get_vector_tfidf</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/internal.py#L61" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_vector_tfidf</code>(<strong><code>sent</code></strong>, <strong><code>dictionary</code></strong>, <strong><code>term_matrix</code></strong>)</p>
</blockquote>
<p>Create a word vector for a given sentence using a term matrix.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_vector_w2v" class="doc_header"><code>get_vector_w2v</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/internal.py#L66" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_vector_w2v</code>(<strong><code>sent</code></strong>, <strong><code>model</code></strong>)</p>
</blockquote>
<p>Create a word vector for a given sentence using a Word2Vec model.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="w2v_pretrained" class="doc_header"><code>w2v_pretrained</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/internal.py#L72" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>w2v_pretrained</code>(<strong><code>bin_file</code></strong>)</p>
</blockquote>
<p>Load a pre-trained Word2Vec model from a bin file.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Clustering">Clustering<a class="anchor-link" href="#Clustering"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_silhouette_score_hac" class="doc_header"><code>get_silhouette_score_hac</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/internal.py#L77" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_silhouette_score_hac</code>(<strong><code>phrase_vecs</code></strong>, <strong><code>linkage_matrix</code></strong>, <strong><code>height</code></strong>)</p>
</blockquote>
<p>Assigns clusters to a list of word vectors for a given <code>height</code> and calculates the silhouette score of the clustering.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_tree_height" class="doc_header"><code>get_tree_height</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/internal.py#L82" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_tree_height</code>(<strong><code>root</code></strong>)</p>
</blockquote>
<p>Gets the height of a binary tree.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_linkage_matrix" class="doc_header"><code>get_linkage_matrix</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/internal.py#L88" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_linkage_matrix</code>(<strong><code>phrase_vecs</code></strong>, <strong><code>dist_metric</code></strong>)</p>
</blockquote>
<p>Creates a linkage matrix by calculating distance between phrase vectors.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_optimal_height" class="doc_header"><code>get_optimal_height</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/internal.py#L96" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_optimal_height</code>(<strong><code>data</code></strong>, <strong><code>linkage_matrix</code></strong>, <strong><code>show_dendrogram</code></strong>=<em><code>False</code></em>, <strong><code>show_chart</code></strong>=<em><code>True</code></em>, <strong><code>save_chart</code></strong>=<em><code>False</code></em>, <strong><code>chart_file</code></strong>=<em><code>'HACSilhouette.png'</code></em>)</p>
</blockquote>
<p>Clusters the top phrase vectors and plots the silhoute coefficients for a range of dendrograph heights.
Returns the optimal height value (highest silhoute coefficient)</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_cluster_assignments_hac" class="doc_header"><code>get_cluster_assignments_hac</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/internal.py#L125" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_cluster_assignments_hac</code>(<strong><code>data</code></strong>, <strong><code>dist_metric</code></strong>, <strong><code>height</code></strong>=<em><code>None</code></em>, <strong><code>show_dendrogram</code></strong>=<em><code>False</code></em>, <strong><code>show_chart</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Use Hierarchical Agglomerative Clustering (HAC) to cluster phrase vectors</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_silhouette_score_kmeans" class="doc_header"><code>get_silhouette_score_kmeans</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/internal.py#L137" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_silhouette_score_kmeans</code>(<strong><code>phrase_vecs</code></strong>, <strong><code>k</code></strong>)</p>
</blockquote>
<p>Assigns clusters to a list of word vectors for a given <code>k</code> and calculates the silhouette score of the clustering.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_optimal_k" class="doc_header"><code>get_optimal_k</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/internal.py#L142" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_optimal_k</code>(<strong><code>data</code></strong>, <strong><code>show_chart</code></strong>=<em><code>True</code></em>, <strong><code>save_chart</code></strong>=<em><code>False</code></em>, <strong><code>chart_file</code></strong>=<em><code>'KmeansSilhouette.png'</code></em>)</p>
</blockquote>
<p>Calculates the optimal k-value (highest silhoute coefficient). Optionally prints a chart of silhouette score by k-value or saves it to disk.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_cluster_assignments_kmeans" class="doc_header"><code>get_cluster_assignments_kmeans</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/internal.py#L161" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_cluster_assignments_kmeans</code>(<strong><code>data</code></strong>, <strong><code>k</code></strong>=<em><code>None</code></em>, <strong><code>show_chart</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Use K-means algorithm to cluster phrase vectors</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Export">Export<a class="anchor-link" href="#Export"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="df_to_disk" class="doc_header"><code>df_to_disk</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/internal.py#L176" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>df_to_disk</code>(<strong><code>df</code></strong>, <strong><code>file_name</code></strong>, <strong><code>mode</code></strong>=<em><code>'w'</code></em>, <strong><code>header</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Writes a dataframe to disk as a tab delimited file.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="sentences_to_disk" class="doc_header"><code>sentences_to_disk</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/internal.py#L184" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>sentences_to_disk</code>(<strong><code>data</code></strong>, <strong><code>file_name</code></strong>=<em><code>'output/DocumentSentenceList.txt'</code></em>)</p>
</blockquote>
<p>Writes the raw sentences to a file organized by document and sentence number.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="write_cluster" class="doc_header"><code>write_cluster</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/internal.py#L191" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>write_cluster</code>(<strong><code>cluster_rows</code></strong>, <strong><code>file_name</code></strong>, <strong><code>mode</code></strong>=<em><code>'a'</code></em>, <strong><code>header</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Appends the rows for a single cluster to disk.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="clusters_to_disk" class="doc_header"><code>clusters_to_disk</code><a href="https://github.com/etfrenchvcu/medtop/tree/master/medtop/internal.py#L197" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>clusters_to_disk</code>(<strong><code>data</code></strong>, <strong><code>doc_df</code></strong>, <strong><code>cluster_df</code></strong>, <strong><code>file_name</code></strong>=<em><code>'output/TopicClusterResults.txt'</code></em>)</p>
</blockquote>
<p>Writes the sentences and phrases to a file organized by cluster and document.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}
</div>
 

